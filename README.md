# Nixdots

> [!CAUTION]
> This flake was build while trying to understand and use nix. It may therefore have drawbacks and missing some development. Feel free to open a pull request if missing anything or want to converse about choices made. Otherwise read this `README.md` further, for a clearer image.

This repository reflects my daily driver laptop configuration, for both my `mac` and `nixos` computers (possibly desktop in the future).

> [!WARNING]
> I have collected my thoughts, sources, and documentation of my development of this flake, up untill I created my `mac` configuration. I highly suggest reading it, or go directly to my sources, as they have helped me immensily in getting started with nix and nixos.

<details>
<summary>Starting out / reflection</summary>

## Starting out / reflection

I got introduced to nixos through youtube, but dominantly through the two nix-tubers [Vimjoyer](http://youtube.com/@vimjoyer) and [Tony](https://www.youtube.com/@tony-btw). Because of my introduction to nix through youtube, I've been quite literally thrown into the mix by starting out with flakes and nixos and home-manager and flake-utils and... you get the jist. That is, because youtubers need to cover what has been popularized to keep their following engaged, they don' often need to present the basics of the language - and following blindly along without the background knowledge does not necessarily yield you any understanding in said language.

I am not trying to shift the blame onto anyone, nor blame the people linked - rather I want to express my own misunderstandings and bad approach onto the subject. And precisely due to my own inapt approach to learning nix, I want to give the below disclaimer.

> Do not throw yourself directly into the nix-ecosystem, start at the basics, and work your way up. Follow the guide provided at [nix.dev](https://nix.dev/tutorials/first-steps/), and only once you have the basics down, should you jump into the frey - that is nixos + flakes (+ home-manager).

</details>

<details>
<summary>Development step-by-step</summary>

## Development

I have tinkered endlessly in another flake, which I've come to call my `test-flake`. Exactly because it became a headache to alter / maintain - as you can read in [my reflection](#starting-out--reflection) - and because now I have switched to a new start.

After a general brush up on some nix fundamentals, I downloaded and installed the nixos gui iso-file. I have tried creating a system from the bottom up before, which ended up being this `test-flake`, so I wanted something different. So I got the basic setup, with gnome as my DE, and from there I followed the documentation on creating a nixos configuration flake, and imported the files produced by this install into it.

After some tinkering, setting up some variables and file structure, like so

```txt
.
├── flake.nix
├── hosts/
│   └── laptop/
│       └── system.nix
└── modules/
    └── system/
        ├── default.nix
        └── [...]/
```

```nix
{
  inputs.nixpkgs.url = "github:NixOs/nixpkgs/nixos-25.11";
  outputs = { nixpkgs, ...}:
   {
    nixosConfigurations."laptop" = nixpkgs.lib.nixosSystem {
      pkgs = (import nixpkgs { system = "x86_64-linux"; });
      modules = [
        ./hosts/laptop/system.nix
        ./modules/system # imports modules/system/default.nix
      ];
    };
  };
}
```

<details>
<summary>Q: Where's the hardware-configuration.nix?</summary>

---

The hardware-configuration.nix file is still stored in `/etc/nixos/hardware-configuration.nix` generated by the `iso`. I'm building the flake using the `--impure` flag, precisely because I have it linked in `system.nix` as an imports file.

This may be my inexperience speaking, but I honestly prefer it that way. Once my hardware has been setup, I prefer not to edit it. No amounts of vcs + rollbacks puts me at ease from accidentally editing my hardware configuration, and going on a 30+ minute deep-dive into `lsblk` and `mount` commands.

---

</details>

---

This was produced together with a random flake guide online, some videos by [Vimjoyer](http://youtube.com/@vimjoyer) and [Tony](https://www.youtube.com/@tony-btw), and personal knowledge from my `test-flake`.

Excactly because I didn't have that much experience in setting up home-manager, especially configuring a standalone home-manager configuration, I needed to consult some guide online. A guide that does not get the credit it deserves, is the one produced by [Evertras](https://github.com/Evertras) called [simple-homemanager](https://github.com/Evertras/simple-homemanager).

His constant `Q: "Are we there yet"` `A: "No..."` seems nagging at first, but actually helps you in creating first, and understanding later. It worked perfectly for me, and I can do nothing but recommend it.

At this point I had created a new home manager configuration to the flake, updating the file structure and flake to the following.

```txt
.
├── flake.nix
├── hosts/
│   └── laptop/
│       ├── system.nix
│       └── home.nix
└── modules/
    ├── system/
    │   ├── default.nix
    │   └── [...]/
    └── home/
        ├── default.nix
        └── [...]/
```

```nix
{
  inputs.nixpkgs.url = "github:NixOs/nixpkgs/nixos-25.11";

  inputs.home-manager.url = "github:nix-community/home-manager/release-25.11";
  inputs.home-manager.inputs.nixpkgs.follows = "nixpkgs";

  outputs = { nixpkgs, home-manager ...}:
   {
    nixosConfigurations."laptop" = nixpkgs.lib.nixosSystem {
      pkgs = (import nixpkgs { system = "x86_64-linux"; });
      modules = [
        ./hosts/laptop/system.nix
        ./modules/system # imports modules/system/default.nix
      ];
    };

    homeConfigurations."laptop" = home-manager.lib.homeManagerConfiguration {
      pkgs = (import nixpkgs { system = "x86_64-linux"; });
      modules = [
        ./hosts/laptop/home.nix
        ./modules/home # imports modules/home/default.nix
      ];
    }
  };
}
```

</details>

<details>
<summary>Sources</summary>

## Sources

These are some sources I've used, put in chronological order for when I needed them and used them.

<!-- TODO: find sources again... why didn't you start here, you know how much documentation means to us! -->

1. [Vimjoyer - NixOs confugration](https://www.youtube.com/watch?v=2eNJy9DSGNw)
   - Gives basic knowlegde of configuration after gui install
   - Presents nix language features
   - Presents option search (important!)
2. [Evertras - Simple home manager setup](https://github.com/Evertras/simple-homemanager)
   - Enables flakes and makes flakes handle home-manager
   - shows general nix configuration options
   - Explains flakes build steps and makefiles to manage them
   - Explains flake inputs & outputs
3. [Tony - Nixos + flakes setup](https://www.youtube.com/watch?v=v5RK3oNRiNY)
   - nixos + flake setup
   - update flake.lock
   - Hardware configuration file global ref (evil, impure... just like me)
   - Shows reproducability of nix-flake
4. [Vimjoyer - NixOs flake configuration](https://www.youtube.com/watch?v=a67Sv4Mbxmc)
   - Explains why nixos
   - Explains channels and packages
   - Why flakes?
   - Shows modularity

> An important note: I feel like it's important, that if you're like me and prefer using the youtube links, that you would probably get more out of the same videos from [LibrePhoenix](https://www.youtube.com/@librephoenix).
>
> I feel like theese videos might have actually been a better start for me, and hence why I'm linking them. Otherwise you can follow the above links to get the same experience as I have.
>
> 1. [LibrePhoenix - nixos installation + flake setup](https://www.youtube.com/watch?v=ACybVzRvDhs)
> 2. [LibrePhoenix - home configuration (standalone)](https://www.youtube.com/watch?v=IiyBeR-Guqw)
> 3. [LibrePhoenix - Modularization](https://www.youtube.com/watch?v=bV3hfalcSKs)

</details>

## If you're not me (or i forgorr)

Well, if you're not me, why'd you download this flake? Please let me know somewhere you could reach me (issue?).

Update the make file to use the correct configuration / configurations by pointing to the name at the end of `.#<config-name>`, otherwise it will only target laptop, as this is the primary target of this flake.

<!-- TODO: finish readme -->
